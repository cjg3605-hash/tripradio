"use strict";(()=>{var e={};e.id=103,e.ids=[103],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},20629:e=>{e.exports=require("fs/promises")},55315:e=>{e.exports=require("path")},1595:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>N,patchFetch:()=>j,requestAsyncStorage:()=>v,routeModule:()=>f,serverHooks:()=>x,staticGenerationAsyncStorage:()=>w});var r={};t.r(r),t.d(r,{GET:()=>h,POST:()=>g});var s=t(49303),o=t(88716),i=t(60670),c=t(87070),n=t(20629),l=t.n(n),u=t(55315),p=t.n(u);let m=p().join(process.cwd(),"saved-guides","history"),d=e=>{let a={알함브라:"alhambra","알함브라 궁전":"alhambra-palace",메스키타:"mezquita","코르도바 메스키타":"mezquita-cordoba","코르도바 메스키타-카테드랄":"mezquita-cordoba","세비야 대성당":"seville-cathedral","히랄다 탑":"giralda-tower","사그라다 파밀리아":"sagrada-familia","구엘 공원":"park-guell","카사 밀라":"casa-mila","카사 바트요":"casa-batllo",몬세라트:"montserrat",플라멩코:"flamenco","레알 알카사르":"real-alcazar",에펠탑:"eiffel-tower","루브르 박물관":"louvre-museum","노트르담 대성당":"notre-dame-cathedral","베르사유 궁전":"versailles-palace",샹젤리제:"champs-elysees",몽마르트:"montmartre",개선문:"arc-de-triomphe",콜로세움:"colosseum",바티칸:"vatican","피사의 사탑":"leaning-tower-pisa",두오모:"duomo",베네치아:"venice",피렌체:"florence",성:"castle",궁전:"palace",대성당:"cathedral",성당:"church",박물관:"museum",공원:"park",광장:"square",다리:"bridge",탑:"tower"},t=e.toLowerCase();return a[e]?a[e]:(Object.entries(a).forEach(([a,r])=>{e.includes(a)&&(t=t.replace(a,r))}),t=t.replace(/[^a-zA-Z0-9가-힣\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),/[가-힣]/.test(t)&&(t=t.replace(/[가-힣]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")),t||(t=`location-${Date.now()}`),t)};async function g(e){try{let{localStorageData:a}=await e.json();if(!a||!Array.isArray(a))return c.NextResponse.json({success:!1,error:"유효하지 않은 데이터 형식입니다."},{status:400});await l().mkdir(m,{recursive:!0});let t=[];for(let e of a)try{let a=d(e.locationName),r=new Date(e.createdAt).getTime(),s=`${a}-${r}.json`,o=p().join(m,s),i={content:e.guideData,metadata:{originalLocationName:e.locationName,englishFileName:s,generatedAt:e.createdAt,migratedAt:new Date().toISOString(),version:"1.0",originalId:e.id,userProfile:e.userProfile,viewedPages:e.viewedPages||[],completed:e.completed||!1}};await l().writeFile(o,JSON.stringify(i,null,2),"utf-8"),t.push({originalLocation:e.locationName,fileName:s,success:!0})}catch(a){t.push({originalLocation:e.locationName,fileName:null,success:!1,error:a instanceof Error?a.message:"알 수 없는 오류"})}let r=t.filter(e=>e.success).length,s=t.filter(e=>!e.success).length;return c.NextResponse.json({success:!0,message:`마이그레이션 완료: 성공 ${r}개, 실패 ${s}개`,results:t,statistics:{total:a.length,success:r,failure:s}})}catch(e){return c.NextResponse.json({success:!1,error:"마이그레이션 중 오류가 발생했습니다."},{status:500})}}async function h(){try{return c.NextResponse.json({success:!0,message:"localStorage 데이터를 POST 방식으로 전송하여 마이그레이션하세요.",instructions:{step1:"localStorage에서 navi_guide_history 데이터를 가져오기",step2:"POST /api/migrate-cache로 데이터 전송",step3:"마이그레이션 완료 후 localStorage 데이터 삭제 (선택사항)"}})}catch(e){return c.NextResponse.json({success:!1,error:"서버 오류"},{status:500})}}let f=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/migrate-cache/route",pathname:"/api/migrate-cache",filename:"route",bundlePath:"app/api/migrate-cache/route"},resolvedPagePath:"C:\\guideai\\src\\app\\api\\migrate-cache\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:v,staticGenerationAsyncStorage:w,serverHooks:x}=f,N="/api/migrate-cache/route";function j(){return(0,i.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:w})}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[380,972],()=>t(1595));module.exports=r})();