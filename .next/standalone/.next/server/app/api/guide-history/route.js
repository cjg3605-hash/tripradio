"use strict";(()=>{var e={};e.id=5,e.ids=[5],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},92048:e=>{e.exports=require("fs")},55315:e=>{e.exports=require("path")},6183:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>j,patchFetch:()=>x,requestAsyncStorage:()=>w,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>v});var r={};a.r(r),a.d(r,{DELETE:()=>g,GET:()=>m});var s=a(49303),i=a(88716),o=a(60670),n=a(87070),l=a(92048),c=a(55315),u=a.n(c);u().join(process.cwd(),"saved-guides"),u().join(process.cwd(),"saved-guides","history");let p=u().join(process.cwd(),"saved-guides","history"),d=e=>{let t={알함브라:"alhambra","알함브라 궁전":"alhambra-palace",메스키타:"mezquita","코르도바 메스키타":"mezquita-cordoba","코르도바 메스키타-카테드랄":"mezquita-cordoba","세비야 대성당":"seville-cathedral","히랄다 탑":"giralda-tower","사그라다 파밀리아":"sagrada-familia","구엘 공원":"park-guell","카사 밀라":"casa-mila","카사 바트요":"casa-batllo",몬세라트:"montserrat",플라멩코:"flamenco","레알 알카사르":"real-alcazar",에펠탑:"eiffel-tower","루브르 박물관":"louvre-museum","노트르담 대성당":"notre-dame-cathedral","베르사유 궁전":"versailles-palace",샹젤리제:"champs-elysees",몽마르트:"montmartre",개선문:"arc-de-triomphe",콜로세움:"colosseum",바티칸:"vatican","피사의 사탑":"leaning-tower-pisa",두오모:"duomo",베네치아:"venice",피렌체:"florence",성:"castle",궁전:"palace",대성당:"cathedral",성당:"church",박물관:"museum",공원:"park",광장:"square",다리:"bridge",탑:"tower"},a=e.toLowerCase();return t[e]?t[e]:(Object.entries(t).forEach(([t,r])=>{e.includes(t)&&(a=a.replace(t,r))}),a=a.replace(/[^a-zA-Z0-9가-힣\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),/[가-힣]/.test(a)&&(a=a.replace(/[가-힣]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")),a||(a=`location-${Date.now()}`),a)};async function m(e){try{let{searchParams:t}=new URL(e.url),a=t.get("location");await l.promises.mkdir(p,{recursive:!0});let r=await l.promises.readdir(p);if(a){let e=d(a),t=r.filter(t=>t.startsWith(e)&&t.endsWith(".json")).sort((e,t)=>{let a=parseInt(e.split("-").pop()?.replace(".json","")||"0");return parseInt(t.split("-").pop()?.replace(".json","")||"0")-a}),s=await Promise.all(t.map(async e=>{let t=u().join(p,e),r=await l.promises.readFile(t,"utf-8"),s=JSON.parse(r);return{fileName:e,locationName:s.metadata?.originalLocationName||a,generatedAt:s.metadata?.generatedAt,preview:s.content?.overview?.title||"No title"}}));return n.NextResponse.json({success:!0,guides:s})}{let e=await Promise.all(r.filter(e=>e.endsWith(".json")).map(async e=>{let t=u().join(p,e),a=await l.promises.readFile(t,"utf-8"),r=JSON.parse(a);return{fileName:e,locationName:r.metadata?.originalLocationName||"Unknown",generatedAt:r.metadata?.generatedAt,preview:r.content?.overview?.title||"No title"}}));return e.sort((e,t)=>new Date(t.generatedAt||0).getTime()-new Date(e.generatedAt||0).getTime()),n.NextResponse.json({success:!0,guides:e})}}catch(e){return n.NextResponse.json({success:!1,error:"히스토리 조회에 실패했습니다."},{status:500})}}async function g(e){try{let{fileName:t}=await e.json();if(!t)return n.NextResponse.json({success:!1,error:"파일명이 필요합니다."},{status:400});let a=u().join(p,t);return await l.promises.unlink(a),n.NextResponse.json({success:!0,message:`${t} 파일이 삭제되었습니다.`})}catch(e){return n.NextResponse.json({success:!1,error:"파일 삭제에 실패했습니다."},{status:500})}}let h=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/guide-history/route",pathname:"/api/guide-history",filename:"route",bundlePath:"app/api/guide-history/route"},resolvedPagePath:"C:\\guideai\\src\\app\\api\\guide-history\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:w,staticGenerationAsyncStorage:v,serverHooks:f}=h,j="/api/guide-history/route";function x(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:v})}}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[380,972],()=>a(6183));module.exports=r})();