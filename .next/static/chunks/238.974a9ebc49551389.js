"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[238],{9763:function(e,r,s){s.d(r,{Z:function(){return n}});var t=s(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(e,r)=>{let s=(0,t.forwardRef)((s,n)=>{let{color:l="currentColor",size:d=24,strokeWidth:c=2,absoluteStrokeWidth:o,children:x,...m}=s;return(0,t.createElement)("svg",{ref:n,...a,width:d,height:d,stroke:l,strokeWidth:o?24*Number(c)/Number(d):c,className:"lucide lucide-".concat(i(e)),...m},[...r.map(e=>{let[r,s]=e;return(0,t.createElement)(r,s)}),...(Array.isArray(x)?x:[x])||[]])});return s.displayName="".concat(e),s}},2660:function(e,r,s){s.d(r,{Z:function(){return t}});let t=(0,s(9763).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1723:function(e,r,s){s.d(r,{Z:function(){return t}});let t=(0,s(9763).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},3774:function(e,r,s){s.d(r,{Z:function(){return t}});let t=(0,s(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},9227:function(e,r,s){s.d(r,{Z:function(){return t}});let t=(0,s(9763).Z)("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]])},3276:function(e,r,s){s.d(r,{Z:function(){return t}});let t=(0,s(9763).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},5238:function(e,r,s){s.r(r),s.d(r,{default:function(){return x}});var t=s(7437),a=s(2265),i=s(2660),n=s(1723),l=s(9227),d=s(3276);let c=(0,s(9763).Z)("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);var o=s(3774);function x(e){var r,s,x,m;let{locationName:h,userProfile:u}=e,[g,b]=(0,a.useState)(null),[p,v]=(0,a.useState)(!0),[j,y]=(0,a.useState)(null),[f,N]=(0,a.useState)(!1),[w,D]=(0,a.useState)(0),[k,L]=(0,a.useState)(!1),C=(0,a.useRef)([]),S=async()=>{v(!0),y(null);try{var e,r,s,t;Object.keys(localStorage).filter(e=>e.includes(h)||e.includes("guide-data")).forEach(e=>{localStorage.removeItem(e)});let a={interests:["문화","역사"],knowledgeLevel:"중급",ageGroup:"30대",preferredStyle:"친근함",...u},i=await fetch("/api/ai/generate-guide",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({locationName:h,userProfile:a,forceRegenerate:!0})}),n=await i.json();n.success&&(null===(t=n.data)||void 0===t?void 0:null===(s=t.content)||void 0===s?void 0:null===(r=s.realTimeGuide)||void 0===r?void 0:null===(e=r.chapters)||void 0===e?void 0:e.length)>0?b(n.data):y(n.error||"실시간 가이드 생성에 실패했습니다.")}catch(e){y("서버 오류가 발생했습니다. 잠시 후 다시 시도해주세요.")}finally{v(!1)}};(0,a.useEffect)(()=>{h&&S()},[h]),(0,a.useEffect)(()=>{let e=()=>{if(!C.current.length)return;let e=window.scrollY+200;for(let r=C.current.length-1;r>=0;r--){let s=C.current[r];if(s&&s.offsetTop<=e){D(r);break}}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[g]);let Z=async()=>{N(!0),await S(),N(!1)},T=e=>{let r=C.current[e];if(r){let e=r.offsetTop-120;window.scrollTo({top:e,behavior:"smooth"})}};if(p)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"실시간 가이드 준비 중..."}),(0,t.jsxs)("p",{className:"text-gray-600",children:[h,"의 특별한 이야기를 생성하고 있습니다"]})]})});if(j||!(null==g?void 0:null===(x=g.content)||void 0===x?void 0:null===(s=x.realTimeGuide)||void 0===s?void 0:null===(r=s.chapters)||void 0===r?void 0:r.length))return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center p-8 max-w-md mx-auto",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)("span",{className:"text-red-500 text-2xl",children:"⚠️"})}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"실시간 가이드를 불러올 수 없습니다"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:j||"콘텐츠가 없습니다. 다시 시도해주세요."}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:Z,disabled:f,className:"w-full px-6 py-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 disabled:opacity-50",children:f?(0,t.jsxs)("div",{className:"flex items-center justify-center",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"다시 생성 중..."]}):"다시 시도"}),(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"w-full px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"돌아가기"})]})]})});let E=g.content.realTimeGuide.chapters,A=E.length,B=e=>{let r=e.match(/📍 시작 위치: (.*?)\n/),s=e.match(/🎯 도착 확인: (.*?)\n/),t=e.match(/▶️ 가이드 시작: (.*)/);return r&&s&&t?{isStart:!0,start:r[1],confirm:s[1],guide:t[1]}:{isStart:!1,fullText:e}},F=e=>{if(!e)return"";let r=e.replace(/\\n/g,"\n");return r.includes("\n")?r:r.replace(/([.!?])\s+/g,"$1\n").replace(/([.!?])$/g,"$1").trim()};return(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-indigo-50 to-white",children:[(0,t.jsxs)("header",{className:"bg-white shadow-sm border-b px-4 py-3 sticky top-0 z-50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,t.jsx)(i.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-semibold text-gray-900",children:"실시간 가이드"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:g.metadata.originalLocationName})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["약 ",g.content.realTimeGuide.totalDuration,"분"]})]})]}),(0,t.jsx)("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:E.map((e,r)=>(0,t.jsxs)("button",{onClick:()=>T(r),className:"flex-shrink-0 px-3 py-1.5 text-xs font-medium rounded-full transition-colors ".concat(w===r?"bg-indigo-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[r+1,". ",e.title.length>15?e.title.substring(0,15)+"...":e.title]},r))})]}),(0,t.jsxs)("main",{className:"px-4 py-6 max-w-4xl mx-auto",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border p-4 mb-8 sticky top-24 z-40",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{L(!k)},className:"w-12 h-12 bg-indigo-500 hover:bg-indigo-600 text-white rounded-full flex items-center justify-center",children:k?(0,t.jsx)(l.Z,{className:"w-6 h-6"}):(0,t.jsx)(d.Z,{className:"w-6 h-6 ml-1"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:(null===(m=E[w])||void 0===m?void 0:m.title)||"실시간 가이드"}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:[w+1," / ",A," 챕터"]})]})]}),(0,t.jsx)(c,{className:"w-5 h-5 text-gray-400"})]})}),(0,t.jsx)("div",{className:"space-y-12",children:E.map((e,r)=>{let s=r===A-1,a=e.nextDirection?B(e.nextDirection):null;return(0,t.jsxs)("div",{ref:e=>{e?C.current[r]=e:delete C.current[r]},children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 transition-all duration-300 ".concat(w===r?"ring-2 ring-indigo-500 scale-102":"shadow-md"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("span",{className:"text-sm font-bold text-indigo-500 bg-indigo-100 px-3 py-1 rounded-full",children:["챕터 ",r+1]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 flex items-center",children:[(0,t.jsx)(n.Z,{className:"w-4 h-4 mr-1.5"}),"약 5분"]})]}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:e.title}),e.sceneDescription&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 border-l-4 border-blue-400 rounded-r-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"\uD83C\uDFAC 현재 장면"}),(0,t.jsx)("p",{className:"text-blue-800 leading-relaxed whitespace-pre-line",children:F(e.sceneDescription)})]}),!e.narrativeLayers&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-400 rounded-r-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-red-900 mb-2",children:"❌ 디버깅: narrativeLayers 없음"}),(0,t.jsx)("p",{className:"text-red-800",children:"이 챕터에는 narrativeLayers가 없습니다."})]}),e.narrativeLayers&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[(0,t.jsx)("h5",{className:"text-xs font-bold text-gray-600 mb-1",children:"\uD83D\uDD0D 디버깅 정보"}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,t.jsxs)("div",{children:["narrativeLayers 키: ",Object.keys(e.narrativeLayers).join(", ")]}),(0,t.jsxs)("div",{children:["coreNarrative: ",e.narrativeLayers.coreNarrative?"".concat(e.narrativeLayers.coreNarrative.length,"자"):"없음"]}),(0,t.jsxs)("div",{children:["architectureDeepDive: ",e.narrativeLayers.architectureDeepDive?"".concat(e.narrativeLayers.architectureDeepDive.length,"자"):"없음"]}),(0,t.jsxs)("div",{children:["humanStories: ",e.narrativeLayers.humanStories?"".concat(e.narrativeLayers.humanStories.length,"자"):"없음"]}),(0,t.jsxs)("div",{children:["sensoryBehindTheScenes: ",e.narrativeLayers.sensoryBehindTheScenes?"".concat(e.narrativeLayers.sensoryBehindTheScenes.length,"자"):"없음"]})]})]}),e.narrativeLayers.coreNarrative&&(0,t.jsxs)("div",{className:"p-4 bg-green-50 border-l-4 border-green-400 rounded-r-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-green-900 mb-2",children:"\uD83D\uDCDA 핵심 이야기"}),(0,t.jsx)("p",{className:"text-green-800 leading-relaxed whitespace-pre-line",children:F(e.narrativeLayers.coreNarrative)})]}),e.narrativeLayers.architectureDeepDive&&(0,t.jsxs)("div",{className:"p-4 bg-purple-50 border-l-4 border-purple-400 rounded-r-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-purple-900 mb-2",children:"\uD83C\uDFDB️ 건축 분석"}),(0,t.jsx)("p",{className:"text-purple-800 leading-relaxed whitespace-pre-line",children:F(e.narrativeLayers.architectureDeepDive)})]}),e.narrativeLayers.humanStories&&(0,t.jsxs)("div",{className:"p-4 bg-orange-50 border-l-4 border-orange-400 rounded-r-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-orange-900 mb-2",children:"\uD83D\uDC65 인물 이야기"}),(0,t.jsx)("p",{className:"text-orange-800 leading-relaxed whitespace-pre-line",children:F(e.narrativeLayers.humanStories)})]}),e.narrativeLayers.sensoryBehindTheScenes&&(0,t.jsxs)("div",{className:"p-4 bg-rose-50 border-l-4 border-rose-400 rounded-r-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-rose-900 mb-2",children:"\uD83C\uDF1F 오감 체험"}),(0,t.jsx)("p",{className:"text-rose-800 leading-relaxed whitespace-pre-line",children:F(e.narrativeLayers.sensoryBehindTheScenes)})]})]})]}),!s&&e.nextDirection&&(0,t.jsxs)("div",{className:"my-8 text-center",children:[(0,t.jsxs)("div",{className:"inline-block relative",children:[(0,t.jsx)("div",{className:"h-16 w-0.5 bg-gray-300 absolute left-1/2 top-[-4rem]"}),(0,t.jsx)("div",{className:"h-16 w-0.5 bg-gray-300 absolute left-1/2 bottom-[-4rem]"}),(0,t.jsx)("div",{className:"bg-white border border-gray-200 rounded-full p-4 shadow-sm",children:(0,t.jsx)(o.Z,{className:"w-6 h-6 text-indigo-500"})})]}),(null==a?void 0:a.isStart)?(0,t.jsxs)("div",{className:"mt-4 max-w-lg mx-auto bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg text-left",children:[(0,t.jsx)("h4",{className:"font-bold text-amber-800 mb-2",children:"투어 시작점 안내"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-amber-700",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{className:"font-semibold",children:"\uD83D\uDCCD 시작 위치:"})," ",a.start]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{className:"font-semibold",children:"\uD83C\uDFAF 도착 확인:"})," ",a.confirm]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{className:"font-semibold",children:"▶️ 가이드 시작:"})," ",a.guide]})]})]}):(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("p",{className:"text-gray-600 whitespace-pre-line",children:F((null==a?void 0:a.fullText)||"")})})]})]},r)})}),g.content.personalizedNote&&(0,t.jsxs)("div",{className:"mt-12 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl p-8 border border-indigo-200",children:[(0,t.jsx)("h4",{className:"font-semibold text-indigo-900 mb-4 text-lg",children:"\uD83D\uDC9D 특별한 메시지"}),(0,t.jsx)("p",{className:"text-indigo-800 leading-relaxed text-lg",children:g.content.personalizedNote})]}),(0,t.jsxs)("div",{className:"mt-12 bg-white rounded-xl shadow-sm border p-8 text-center",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDF89"}),(0,t.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"투어 완료!"}),(0,t.jsxs)("p",{className:"text-gray-600 mb-6",children:[g.metadata.originalLocationName,"의 특별한 이야기와 함께 해주셔서 감사합니다."]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"px-8 py-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors text-lg font-medium",children:"다른 명소 탐험하기"}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:"이 가이드가 도움이 되셨나요? 다른 명소도 함께 탐험해보세요!"})]})]})]}),(0,t.jsx)("div",{className:"h-20"})]})}}}]);